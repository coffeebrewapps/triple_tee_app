import{u as ye}from"./input-ae6e7048.js";import{u as he}from"./errors-53bc63a8.js";import{u as Ue}from"./validations-9a1af222.js";import{_ as ke,r as T,c as x,w as Fe,o as De,b as u,d as U,j as B,F as S,y as I,H as Oe,D as _,f as b,g as t,B as Te,e as m,T as Be,N as Ce,U as ze,V as je,l as we,W as $,X as Me,Y as xe,Z as P,k as C,a0 as Se,$ as E,a1 as Ie}from"./index-522b32ec.js";const _e={class:"body"},$e={class:"field-input"},Pe={key:0,class:"field-toggle"},Ee={key:0,class:"actions"},Le={__name:"DataForm",props:{modelValue:{type:Object,default(){return{}}},fieldsLayout:{type:Array,default(){return[]}},dataFields:{type:Array,default(){return[]}},schemas:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},compact:{type:Boolean,default:!1},submittable:{type:Boolean,default:!0},confirmButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-check",value:"Confirm"}}},cancelButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-xmark",value:"Cancel"}}}},emits:["update:modelValue","submit","cancel"],setup(V,{emit:z}){const g=V,{schemasMap:k,serverOptionsFields:L,inputType:c,inputLabel:r,inputableField:N,multiInputableField:R,multiSelectableField:H,singleSelectableField:A,nullToggleableField:F,nullToggleableFields:G,objectField:W,fileFields:X,fileField:Y,formatInputOptionsData:Z,fetchOptions:q,initOptionsData:J}=ye(g.schemas),{notEmpty:j}=Ue(),K=he(),D=T(G.value.reduce((a,s)=>(a[s]=!1,a),{}));function i(a){return!F(a)||D.value[a]}function Q(a){return i(a)&&N(a)}function f(a){return i(a)&&Y(a)}function ee(a){return i(a)&&(R(a)||W(a))}function ae(a){return i(a)&&c(a)==="date"}function te(a){return i(a)&&c(a)==="datetime"}function ne(a){return i(a)&&(c(a)==="enum"||c(a)==="select")}function oe(a){return i(a)&&c(a)==="daterange"}function se(a){return i(a)&&c(a)==="datetimerange"}function le(a){return i(a)&&c(a)==="boolean"}function p(a){return g.dataFields.find(s=>s===a)}function ue(a){return`Has ${r(a)}`}function re(a){return(c(a)==="select"||c(a)==="enum")&&k.value[a].options.length>30}function d(a){return!g.errorMessages||!g.errorMessages[a]?"":g.errorMessages[a].map(s=>K[s.name](s.params)).join(", ")}const{fileToBase64:w}=Ie();function me(a){const s=Object.assign({},a);return X.value.forEach(l=>{j(s[l])&&j(g.modelValue[l])&&ce(s[l],g.modelValue[l]).then(y=>{y&&(s[l]=null)}).catch(y=>{console.error(y)})}),s}async function ce(a,s){return new Promise((l,y)=>{const e=[w(a),w(s)];Promise.all(e).then(h=>{l(h[0]===h[1])}).catch(h=>{y(h)})})}const O=T({});function v(a){return O.value[a]}function ie(a){return i(a)&&A(a)&&!!v(a)}function pe(a){return i(a)&&H(a)&&!!v(a)}const M=x(()=>L.value.reduce((a,s)=>(a[s]=l=>{de(s,l)},a),{}));async function de(a,s){const l=k.value[a].limit||5;await q(a,s).then(y=>{O.value[a]=Z(a,s,l,y)})}const n=T({});Fe(g.modelValue,(a,s)=>{n.value=Object.assign({},a)});const be=x(()=>g.compact?"form compact":"form");function ge(a){return F(a)?"data-field toggleable":"data-field"}function ve(){const a=me(n.value);z("submit",a)}function Ve(){z("cancel")}return De(async()=>{n.value=Object.assign({},g.modelValue),await J().then(a=>{O.value=a}).catch(a=>{console.error(a)})}),(a,s)=>(u(),U("div",{class:_(t(be))},[B("div",_e,[(u(!0),U(S,null,I(V.fieldsLayout,(l,y)=>(u(),U("div",{key:y,class:"data-row"},[(u(!0),U(S,null,I(Object.keys(l),(e,h)=>Oe(a.$slots,`form-col.${e}`,Se({key:h},{field:e,type:t(c)(e),label:t(r)(e)}),()=>[B("div",{class:_(ge(e))},[B("div",$e,[Q(e)?(u(),b(t(Te),{key:0,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,type:t(c)(e),label:t(r)(e),size:l[e],disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","type","label","size","disabled","error-message"])):m("",!0),f(e)?(u(),b(t(Be),{key:1,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),size:l[e],disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","size","disabled","error-message"])):m("",!0),ee(e)?(u(),b(t(Ce),{key:2,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0),ae(e)?(u(),b(t(ze),{key:3,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),disabled:!p(e),"align-pickers":"top","error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0),te(e)?(u(),b(t(je),{key:4,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),disabled:!p(e),"display-time":!0,"align-pickers":"top","error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0),ne(e)?(u(),b(t(we),{key:5,id:e,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),name:e,options:t(k)[e].options,size:l[e],disabled:!p(e),searchable:re(e),"error-message":d(e)},null,8,["id","modelValue","onUpdate:modelValue","label","name","options","size","disabled","searchable","error-message"])):m("",!0),ie(e)?(u(),b(t($),{key:6,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),name:t(r)(e),multiple:!1,options:v(e).data,"options-length":v(e).total,"options-loading":v(e).loading,pagination:v(e).pagination,size:l[e],disabled:!p(e),"error-message":d(e),onOffsetChange:t(M)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):m("",!0),pe(e)?(u(),b(t($),{key:7,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),name:t(r)(e),options:v(e).data,"options-length":v(e).total,"options-loading":v(e).loading,pagination:v(e).pagination,size:l[e],disabled:!p(e),"error-message":d(e),onOffsetChange:t(M)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):m("",!0),oe(e)&&n.value[e]?(u(),b(t(Me),{key:8,"start-date":n.value[e].startDate,"onUpdate:startDate":o=>n.value[e].startDate=o,"end-date":n.value[e].endDate,"onUpdate:endDate":o=>n.value[e].endDate=o,label:t(r)(e),disabled:!p(e),"error-message":d(e)},null,8,["start-date","onUpdate:startDate","end-date","onUpdate:endDate","label","disabled","error-message"])):m("",!0),se(e)&&n.value[e]?(u(),b(t(xe),{key:9,"start-time":n.value[e].startTime,"onUpdate:startTime":o=>n.value[e].startTime=o,"end-time":n.value[e].endTime,"onUpdate:endTime":o=>n.value[e].endTime=o,label:t(r)(e),disabled:!p(e),"error-message":d(e)},null,8,["start-time","onUpdate:startTime","end-time","onUpdate:endTime","label","disabled","error-message"])):m("",!0),le(e)?(u(),b(t(P),{key:10,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(r)(e),disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0)]),t(F)(e)?(u(),U("div",Pe,[C(t(P),{modelValue:D.value[e],"onUpdate:modelValue":o=>D.value[e]=o,label:ue(e)},null,8,["modelValue","onUpdate:modelValue","label"])])):m("",!0)],2)],!0)),128))]))),128))]),V.submittable?(u(),U("div",Ee,[C(t(E),{class:"button","button-type":V.confirmButton.type,value:V.confirmButton.value,icon:V.confirmButton.icon,onClick:s[0]||(s[0]=l=>ve())},null,8,["button-type","value","icon"]),C(t(E),{class:"button","button-type":V.cancelButton.type,value:V.cancelButton.value,icon:V.cancelButton.icon,onClick:s[1]||(s[1]=l=>Ve())},null,8,["button-type","value","icon"])])):m("",!0)],2))}},Ge=ke(Le,[["__scopeId","data-v-4fbe4a1b"]]);export{Ge as D};
