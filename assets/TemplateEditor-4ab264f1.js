import{_ as ne,m as oe,a as le,L as ie,r as a,c as p,o as ce,b as f,d as T,i as e,j as L,v as h,C as g,g as l,t as v,e as y,f as D,y as de,J as re,M as ue,q as pe,P as fe,K as ve,p as _e,h as me}from"./index-456a89cc.js";import{T as he}from"./TabContainer-65d2b41a.js";const o=s=>(_e("data-v-d6135911"),s=s(),me(),s),ye={class:"preview-template"},be={class:"template-editor"},ke=o(()=>e("i",{class:"fa-solid fa-xmark"},null,-1)),ge=[ke],Se=["contenteditable"],Ee=o(()=>e("i",{class:"fa-solid fa-pencil"},null,-1)),we=[Ee],Ce=o(()=>e("i",{class:"fa-solid fa-check"},null,-1)),Me=[Ce],Te={key:0,class:"error-message"},De=o(()=>e("i",{class:"fa-solid fa-xmark"},null,-1)),Pe=[De],xe=["contenteditable"],Ne=o(()=>e("i",{class:"fa-solid fa-pencil"},null,-1)),Re=[Ne],Ve=o(()=>e("i",{class:"fa-solid fa-check"},null,-1)),Le=[Ve],je={key:0,class:"error-message"},Be=o(()=>e("i",{class:"fa-solid fa-xmark"},null,-1)),Oe=[Be],Ge=["contenteditable"],Ie=o(()=>e("i",{class:"fa-solid fa-pencil"},null,-1)),Ae=[Ie],Fe=o(()=>e("i",{class:"fa-solid fa-check"},null,-1)),qe=[Fe],Je={class:"preview-container"},Ue=o(()=>e("h3",{class:"heading"}," Preview ",-1)),He=["innerHTML"],$e={class:"buttons"},ze=o(()=>e("div",{class:"message"}," Generating PDF... ",-1)),Ke={__name:"TemplateEditor",props:{id:{type:String,default:null},contentMarkup:{type:String,default:""},contentStyles:{type:String,default:""},disabled:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},enableGenerate:{type:Boolean,default:!0},templateType:{type:String,default:null}},emits:["contentMarkupChange","contentStylesChange","dataChange"],setup(s,{emit:S}){const n=s,E=oe(),j=le(),B=new ie,O=a("style"),P=p(()=>({contentMarkup:n.contentMarkup,contentStyles:n.contentStyles})),G=[{label:"Markup"},{label:"Styles"},{label:"Data"}],w=a("markupEditor"),x=a("stylesEditor"),C=a("sampleDataEditor"),d=a(!1),r=a(!1),u=a(!1),I=p(()=>{const t=[];return t.push("editor"),d.value&&t.push("editable"),n.disabled&&t.push("disabled"),t.join(" ")}),A=p(()=>{const t=[];return t.push("editor"),r.value&&t.push("editable"),n.disabled&&t.push("disabled"),t.join(" ")}),F=p(()=>{const t=[];return t.push("editor"),u.value&&t.push("editable"),n.disabled&&t.push("disabled"),t.join(" ")});function q(){d.value=!0}async function J(){m.value=!1,await M().then(t=>{X()}).catch(t=>{m.value=!0,_.value="Markup error",console.log(t)}).finally(()=>{d.value=!1})}function U(){r.value=!0}function H(){Y(),r.value=!1}function $(){u.value=!0}async function z(){m.value=!1,await M().then(t=>{Z()}).catch(t=>{m.value=!0,_.value="Sample data error",console.log(t)}).finally(()=>{u.value=!1})}function K(){d.value=!d.value}function Q(){r.value=!r.value}function W(){u.value=!u.value}function X(){S("contentMarkupChange",w.value.innerText)}function Y(){S("contentStylesChange",x.value.innerText)}function Z(){S("dataChange",JSON.parse(C.value.innerText))}const N=p(()=>n.data),ee=p(()=>m.value?"preview-content error":"preview-content"),_=a(),m=a(!1);async function M(){return new Promise((t,c)=>{_.value=null,B.parseAndRender(w.value.innerText,JSON.parse(C.value.innerText)).then(i=>{_.value=i,t(i)}).catch(i=>{c(i)})})}const b=a(!1),k=a(),R=a(),V=a();async function te(){k.value=null,b.value=!0,await j.downloadStream(n.templateType,n.id,N.value,{path:"pdf"}).then(t=>{const c=new Blob([t.data],{type:"application/pdf"}),i=window.URL.createObjectURL(c);R.value=i,V.value=`${n.templateType}_${n.id}.pdf`,k.value=i,ae()}).catch(t=>{console.log(t)}).finally(()=>{se()})}function ae(){const t=Object.assign({},E.currentRoute.value),c={path:"/document_templates/:templateType/:id/pdf",name:"View Pdf",component:()=>ve(()=>import("./PdfViewer-1888ecfd.js"),["assets/PdfViewer-1888ecfd.js","assets/index-456a89cc.js","assets/index-e97cec44.css","assets/PdfViewer-652058bc.css"]),props:{templatePdfData:k.value,downloadLink:R.value,downloadFile:V.value},meta:{parentRoute:{name:t.name},hidden:!0}};E.addRoute(c),E.push({name:"View Pdf",params:{templateType:n.templateType,id:n.id}})}function se(){b.value=!1}return ce(async()=>{await M()}),(t,c)=>(f(),T("div",ye,[e("div",be,[L(he,{tabs:G},{"tab-0":h(()=>[e("div",{class:g(l(I))},[e("div",{class:"editor-button cancel",onClick:K},ge),e("div",{ref_key:"markupEditor",ref:w,class:"editor-content",contenteditable:d.value},v(l(P).contentMarkup),9,Se),e("div",{class:"editor-button edit",onClick:q},we),e("div",{class:"editor-button confirm",onClick:J},Me)],2),s.errorMessages.contentMarkup?(f(),T("div",Te,v(s.errorMessages.contentMarkup),1)):y("",!0)]),"tab-1":h(()=>[e("div",{class:g(l(A))},[e("div",{class:"editor-button cancel",onClick:Q},Pe),e("div",{ref_key:"stylesEditor",ref:x,class:"editor-content",contenteditable:r.value},v(l(P).contentStyles),9,xe),e("div",{class:"editor-button edit",onClick:U},Re),e("div",{class:"editor-button confirm",onClick:H},Le)],2),s.errorMessages.contentStyles?(f(),T("div",je,v(s.errorMessages.contentStyles),1)):y("",!0)]),"tab-2":h(()=>[e("div",{class:g(l(F))},[e("div",{class:"editor-button cancel",onClick:W},Oe),e("div",{ref_key:"sampleDataEditor",ref:C,class:"editor-content",contenteditable:u.value},v(l(N)),9,Ge),e("div",{class:"editor-button edit",onClick:$},Ae),e("div",{class:"editor-button confirm",onClick:z},qe)],2)]),_:1})]),e("div",Je,[Ue,e("div",{class:g(l(ee)),innerHTML:_.value},null,10,He),s.contentStyles?(f(),D(re(O.value),{key:0},{default:h(()=>[de(v(s.contentStyles),1)]),_:1})):y("",!0),e("div",$e,[s.enableGenerate?(f(),D(l(ue),{key:0,value:"Generate",icon:"fa-solid fa-file-export",onClick:te})):y("",!0)])]),L(l(fe),{modelValue:b.value,"onUpdate:modelValue":c[0]||(c[0]=i=>b.value=i),class:"generate-dialog",title:"Generating PDF",width:400,height:250},{body:h(()=>[k.value?y("",!0):(f(),D(l(pe),{key:0})),ze]),_:1},8,["modelValue"])]))}},Xe=ne(Ke,[["__scopeId","data-v-d6135911"]]);export{Xe as T};
