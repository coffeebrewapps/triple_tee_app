import{_ as k,a as J,u as U,r as n,w as A,c as _,o as B,b,d as E,j as p,g as i,f as C,e as I,s as L,k as M,X as $,M as j,p as F,h as T,i as X}from"./index-4d73f140.js";const z=v=>(F("data-v-75bf7660"),v=v(),T(),v),q={class:"page-container"},G=z(()=>X("h2",{class:"heading"}," Data Admin ",-1)),H={__name:"DataAdmin",setup(v){const f=J(),m=U(),t=n();A(t,async(e,a)=>{await y()});const o=n(!0),w=_(()=>`Data (Total: ${Object.keys(u.value).length})`),u=n([]),c=n(""),d=n(""),r=n(!1),S=[{value:"indexes",label:"Indexes"}],h=n([]),V=_(()=>S.concat(h.value));async function x(){await f.schemas().then(e=>{h.value=e.map(a=>({value:a,label:a})),l("Loaded model class options successfully!")}).catch(e=>{r.value=!0,d.value=JSON.stringify(e,!1,4),l("Error loading model class options!")})}async function y(){u.value=[],t.value&&(o.value=!0,await f.list(t.value).then(e=>{u.value=e.data,c.value=JSON.stringify(u.value,!1,4),l(`Fetched ${t.value} successfully!`)}).catch(e=>{r.value=!0,d.value=JSON.stringify(e,!1,4),l(`Error fetching ${t.value} data!`)}).finally(()=>{o.value=!1}))}function N(e){return JSON.parse(e).reduce((a,s)=>{const g=Object.assign({},s);return delete g.includes,a[s.id]=g,a},{})}async function O(){o.value=!0,t.value==="indexes"?await f.upload("indexes",JSON.parse(c.value)).then(e=>{u.value=e.data,c.value=JSON.stringify(u.value,!1,4),l("Updated indexes successfully!")}).catch(e=>{r.value=!0,d.value=JSON.stringify(e,!1,4),l("Error updating indexes!")}).finally(()=>{o.value=!1}):await f.upload(t.value,N(c.value)).then(e=>{l(`Updated ${t.value} data successfully!`),y()}).catch(e=>{r.value=!0,d.value=JSON.stringify(e,!1,4),l(`Error updating ${t.value} data!`)}).finally(()=>{o.value=!1})}function l(e){m.show(e),setTimeout(D,5e3)}function D(){m.hide()}return B(async()=>{await x()}),(e,a)=>(b(),E("div",q,[G,p(i(L),{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value=s),label:"Model Class",name:"model-class",options:i(V),size:"lg"},null,8,["modelValue","options"]),p(i(M),{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=s=>c.value=s),label:i(w),rows:30,cols:150,disabled:o.value},null,8,["modelValue","label","disabled"]),d.value.length>0?(b(),C(i($),{key:0,modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=s=>r.value=s),title:"Error",class:"error-alert",content:d.value,width:800,height:500},null,8,["modelValue","content"])):I("",!0),p(i(j),{"button-type":"text",value:"Update",icon:"fa-solid fa-check",onClick:O})]))}},P=k(H,[["__scopeId","data-v-75bf7660"]]);export{P as default};
