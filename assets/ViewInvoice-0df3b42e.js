import{_ as $,j as H,k as K,u as P,c as d,r as u,o as z,a as t,b as i,h as m,t as f,f as o,e as b,Z as G,d as r,l as h,F as V,m as B,i as J}from"./index-0145d739.js";import{u as Q}from"./Form-a8ccb837.js";import{a as W}from"./dataAccess-952e8a85.js";import{T as X}from"./TabContainer-f09b204c.js";import"./DataPage-c0c28866.js";import{u as Y}from"./utils-9d158d61.js";import ee from"./view-de2ef63f.js";import{T as ne}from"./TemplateEditor-8df5c89d.js";import"./errors-a6177d44.js";const ae={class:"page-container"},te={class:"heading"},oe={class:"details-container"},ie={class:"data-row"},se={class:"data-field"},ce={class:"field-label"},le={class:"field-value"},ue={key:0},re={key:1},ve={__name:"ViewInvoice",setup(de){const E=H(),y=W(),N=K(),g=P(),I=Object.assign({},E.currentRoute.value),k=d(()=>I.params.id),S=d(()=>I.query.contactId),{invoicesUrl:me,invoiceLinesUrl:pe,invoiceConfigsUrl:_e,templatesUrl:x,fieldsLayout:F,generateDataFields:U}=Y(),L=d(()=>U(S.value)),{inputLabel:q,inputValue:j,includeKeys:w}=Q(L.value),e=u(),p=u(),n=u(),s=u(),T=u(),R=d(()=>e.value?`Invoice: ${e.value.invoiceNumber}`:"Loading Invoice...");async function C(){e.value=null;const a={include:w.value};await y.view("invoices",k.value,a).then(c=>{e.value=c,v("Loaded invoice successfully!")}).catch(c=>{console.error(c),v("Error loading invoice!")})}async function A(){p.value=null,n.value=null,s.value=null,y.view("invoices",e.value.id,{},{path:"template_data"}).then(a=>{p.value=a.invoiceLines,n.value=a.invoiceConfig,s.value=n.value.includes.invoiceTemplateId[n.value.invoiceTemplateId];const c=n.value.includes.invoiceNumberSequenceId[n.value.invoiceNumberSequenceId],_=n.value.includes.billingContactId[n.value.billingContactId],l=n.value.includes.currencyId[n.value.currencyId];T.value={invoice:e.value,invoiceLines:p.value,invoiceConfig:n.value,invoiceNumberSequence:c,billingContact:_,currency:l},v("Loaded template data successfully!")}).catch(a=>{console.error(a),v("Error loading template data!")})}function v(a){g.show(a),setTimeout(M,5e3)}function M(){g.hide()}const D=[{label:"Details",onchange:C},{label:"Invoice Lines",onchange:O},{label:"View Invoice PDF",onchange:A}];async function O(){N.emitEvent("loadData",{dataType:"Invoice Lines"})}function Z(a){D[a].onchange()}return z(async()=>{await C()}),(a,c)=>(t(),i("div",ae,[m("h2",te,f(o(R)),1),e.value?r("",!0):(t(),b(o(G),{key:0})),e.value?(t(),b(X,{key:1,tabs:D,onTabChange:Z},{"tab-0":h(()=>[m("div",oe,[(t(!0),i(V,null,B(o(F),_=>(t(),i("div",ie,[(t(!0),i(V,null,B(Object.keys(_),l=>(t(),i("div",se,[m("div",ce,f(o(q)(l)),1),m("div",le,[e.value&&e.value[l]?(t(),i("span",ue,f(o(j)(l,e.value,o(w),o(L))),1)):r("",!0),!e.value||!e.value[l]?(t(),i("span",re," --- no value --- ")):r("",!0)])]))),256))]))),256))])]),"tab-1":h(()=>[J(ee,{"invoice-id":o(k)},null,8,["invoice-id"])]),"tab-2":h(()=>[s.value?(t(),b(ne,{key:0,"templates-url":o(x),id:s.value.id,"content-markup":s.value.contentMarkup,"content-styles":s.value.contentStyles,data:T.value,disabled:!0,"template-type":"invoice_templates"},null,8,["templates-url","id","content-markup","content-styles","data"])):r("",!0)]),_:1})):r("",!0)]))}},Te=$(ve,[["__scopeId","data-v-3ab8b7f3"]]);export{Te as default};
