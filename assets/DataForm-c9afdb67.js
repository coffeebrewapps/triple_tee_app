import{u as ce}from"./input-701303c2.js";import{u as pe}from"./errors-a6177d44.js";import{_ as de,c as T,r as j,o as ie,b as r,d as h,i as C,F as w,x,G as be,C as z,f as b,g as t,A as ge,e as u,k as ye,W as Ve,S as he,s as ve,T as S,U as Ue,V as ke,Y as _,j as O,$ as De,M as I}from"./index-456a89cc.js";const Fe={class:"body"},Te={class:"field-input"},Ce={key:0,class:"field-toggle"},Oe={key:0,class:"actions"},Be={__name:"DataForm",props:{modelValue:{type:Object,default(){return{}}},fieldsLayout:{type:Array,default(){return[]}},dataFields:{type:Array,default(){return[]}},schemas:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},compact:{type:Boolean,default:!1},submittable:{type:Boolean,default:!0},confirmButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-check",value:"Confirm"}}},cancelButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-xmark",value:"Cancel"}}}},emits:["update:modelValue","submit","cancel"],setup(g,{emit:v}){const V=g,n=T({get:()=>V.modelValue,set:a=>{v("update:modelValue",a)}}),{schemasMap:B,serverOptionsFields:$,inputType:y,inputLabel:l,inputableField:L,multiInputableField:A,multiSelectableField:E,singleSelectableField:N,nullToggleableField:U,nullToggleableFields:P,objectField:H,formatInputOptionsData:R,fetchOptions:W,initOptionsData:G}=ce(V.schemas),Y=pe(),k=j(P.value.reduce((a,s)=>(a[s]=!1,a),{}));function c(a){return!U(a)||k.value[a]}function q(a){return c(a)&&L(a)}function J(a){return c(a)&&(A(a)||H(a))}function K(a){return c(a)&&y(a)==="date"}function Q(a){return c(a)&&y(a)==="datetime"}function X(a){return c(a)&&(y(a)==="enum"||y(a)==="select")}function Z(a){return c(a)&&y(a)==="daterange"}function f(a){return c(a)&&y(a)==="datetimerange"}function ee(a){return c(a)&&y(a)==="boolean"}function p(a){return V.dataFields.find(s=>s===a)}function ae(a){return`Has ${l(a)}`}function d(a){return!V.errorMessages||!V.errorMessages[a]?"":V.errorMessages[a].map(s=>Y[s.name](s.params)).join(", ")}const D=j({});function i(a){return D.value[a]}function te(a){return c(a)&&N(a)&&!!i(a)}function ne(a){return c(a)&&E(a)&&!!i(a)}const M=T(()=>$.value.reduce((a,s)=>(a[s]=m=>{oe(s,m)},a),{}));async function oe(a,s){const m=B.value[a].limit||5;await W(a,s).then(F=>{D.value[a]=R(a,s,m,F)})}const se=T(()=>V.compact?"form compact":"form");function re(a){return U(a)?"data-field toggleable":"data-field"}function le(){v("submit",n.value)}function ue(){v("cancel")}return ie(async()=>{await G().then(a=>{D.value=a}).catch(a=>{console.error(a)})}),(a,s)=>(r(),h("div",{class:z(t(se))},[C("div",Fe,[(r(!0),h(w,null,x(g.fieldsLayout,(m,F)=>(r(),h("div",{key:F,class:"data-row"},[(r(!0),h(w,null,x(Object.keys(m),(e,me)=>be(a.$slots,`form-col.${e}`,De({key:me},{field:e,type:t(y)(e),label:t(l)(e)}),()=>[C("div",{class:z(re(e))},[C("div",Te,[q(e)?(r(),b(t(ge),{key:0,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,type:t(y)(e),label:t(l)(e),size:m[e],disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","type","label","size","disabled","error-message"])):u("",!0),J(e)?(r(),b(t(ye),{key:1,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),K(e)?(r(),b(t(Ve),{key:2,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!p(e),"align-pickers":"top","error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),Q(e)?(r(),b(t(he),{key:3,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!p(e),"display-time":!0,"align-pickers":"top","error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),X(e)?(r(),b(t(ve),{key:4,id:e,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,options:t(B)[e].options,size:m[e],disabled:!p(e),"error-message":d(e)},null,8,["id","modelValue","onUpdate:modelValue","label","name","options","size","disabled","error-message"])):u("",!0),te(e)?(r(),b(t(S),{key:5,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:t(l)(e),multiple:!1,options:i(e).data,"options-length":i(e).total,"options-loading":i(e).loading,pagination:i(e).pagination,size:m[e],disabled:!p(e),"error-message":d(e),onOffsetChange:t(M)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):u("",!0),ne(e)?(r(),b(t(S),{key:6,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:t(l)(e),options:i(e).data,"options-length":i(e).total,"options-loading":i(e).loading,pagination:i(e).pagination,size:m[e],disabled:!p(e),"error-message":d(e),onOffsetChange:t(M)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):u("",!0),Z(e)?(r(),b(t(Ue),{key:7,"start-date":t(n)[e].startDate,"onUpdate:startDate":o=>t(n)[e].startDate=o,"end-date":t(n)[e].endDate,"onUpdate:endDate":o=>t(n)[e].endDate=o,label:t(l)(e),disabled:!p(e),"error-message":d(e)},null,8,["start-date","onUpdate:startDate","end-date","onUpdate:endDate","label","disabled","error-message"])):u("",!0),f(e)?(r(),b(t(ke),{key:8,"start-time":t(n)[e].startTime,"onUpdate:startTime":o=>t(n)[e].startTime=o,"end-time":t(n)[e].endTime,"onUpdate:endTime":o=>t(n)[e].endTime=o,label:t(l)(e),disabled:!p(e),"error-message":d(e)},null,8,["start-time","onUpdate:startTime","end-time","onUpdate:endTime","label","disabled","error-message"])):u("",!0),ee(e)?(r(),b(t(_),{key:9,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!p(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0)]),t(U)(e)?(r(),h("div",Ce,[O(t(_),{modelValue:k.value[e],"onUpdate:modelValue":o=>k.value[e]=o,label:ae(e)},null,8,["modelValue","onUpdate:modelValue","label"])])):u("",!0)],2)],!0)),128))]))),128))]),g.submittable?(r(),h("div",Oe,[O(t(I),{class:"button","button-type":g.confirmButton.type,value:g.confirmButton.value,icon:g.confirmButton.icon,onClick:s[0]||(s[0]=m=>le())},null,8,["button-type","value","icon"]),O(t(I),{class:"button","button-type":g.cancelButton.type,value:g.cancelButton.value,icon:g.cancelButton.icon,onClick:s[1]||(s[1]=m=>ue())},null,8,["button-type","value","icon"])])):u("",!0)],2))}},xe=de(Be,[["__scopeId","data-v-850b7504"]]);export{xe as D};
