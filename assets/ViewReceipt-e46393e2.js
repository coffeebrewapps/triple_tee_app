import{u as q}from"./input-811f8f86.js";import{_ as H,a as K,v as P,u as U,n as $,b as C,r as d,d as z,o as s,c as n,j as m,t as y,g as a,f as g,D as G,e as l,q as I,F as S,y as V}from"./index-b3ed4318.js";import{u as J}from"./utils-988c526d.js";import{T as Q}from"./TabContainer-41a4bb62.js";import{T as W}from"./TemplateEditor-6070bea0.js";const X={class:"page-container"},Y={class:"heading"},Z={key:0,class:"details-container"},ee={class:"field-label"},te={class:"field-value"},ae={key:0},se={key:1},ne={__name:"ViewReceipt",props:{contactId:{type:String,default:null},receiptId:{type:String,default:null},invoiceId:{type:String,default:null}},setup(E){const p=E,f=K(),{isEmpty:b,notEmpty:h}=P(),{flashMessage:i}=U(),L=$(),{fieldsLayout:x,generateDataFields:B}=J(),k=C(()=>B(p.invoiceId,p.contactId)),{inputLabel:F,inputValue:N,includeKeys:w}=q(k.value),t=d(),c=d(),T=d(),j=C(()=>t.value?`Receipt: ${t.value.receiptNumber}`:"Loading Receipt...");async function D(){t.value=null;const e={include:w.value};await f.view("income_receipts",p.receiptId,e).then(o=>{t.value=o,i("Loaded receipt successfully!")}).catch(o=>{console.error(o),i("Error loading receipt!")})}async function M(){c.value=null,f.view("income_receipts",t.value.id,{},{path:"template_data"}).then(e=>{c.value=e.receiptTemplate;const o=e.country,v=e.logo,_=Object.assign({},e.billingContact,{country:o.countryName,logo:v.rawData});T.value=Object.assign({},e,{billingContact:_}),i("Loaded template data successfully!")}).catch(e=>{console.error(e),i("Error loading template data!")})}const r=d(0),R=[{label:"Details",onchange:D},{label:"View Receipt PDF",onchange:M}];async function O(e){await R[e].onchange(),r.value=e}return z(async()=>{await D()}),(e,o)=>(s(),n("div",X,[m("h2",Y,y(a(j)),1),t.value?l("",!0):(s(),g(a(G),{key:0})),t.value?(s(),g(Q,{key:1,"selected-tab":r.value,tabs:R,onTabChange:O},{"tab-0":I(()=>[r.value===0?(s(),n("div",Z,[(s(!0),n(S,null,V(a(x),(v,_)=>(s(),n("div",{key:_,class:"data-row"},[(s(!0),n(S,null,V(Object.keys(v),(u,A)=>(s(),n("div",{key:A,class:"data-field"},[m("div",ee,y(a(F)(u)),1),m("div",te,[a(h)(t.value)&&a(h)(t.value[u])?(s(),n("span",ae,y(a(N)(u,t.value,a(w),a(k),a(L))),1)):l("",!0),a(b)(t.value)||a(b)(t.value[u])?(s(),n("span",se," --- no value --- ")):l("",!0)])]))),128))]))),128))])):l("",!0)]),"tab-1":I(()=>[r.value===1&&c.value?(s(),g(W,{key:0,id:c.value.id,"template-type":"receipt_templates","content-markup":c.value.contentMarkup,"content-styles":c.value.contentStyles,data:T.value,disabled:!0},null,8,["id","content-markup","content-styles","data"])):l("",!0)]),_:1},8,["selected-tab"])):l("",!0)]))}},ue=H(ne,[["__scopeId","data-v-dd315a71"]]);export{ue as default};
