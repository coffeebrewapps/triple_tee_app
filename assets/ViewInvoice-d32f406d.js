import{_ as z,n as G,a as J,q as Q,u as W,m as X,c as m,r as u,o as Y,b as n,d as o,j as b,t as h,g as t,f as p,s as Z,e as c,v as I,F as x,y as B}from"./index-522b32ec.js";import{u as ee}from"./input-ae6e7048.js";import{u as ae}from"./validations-9a1af222.js";import{u as te}from"./utils-7b0831a9.js";import{T as ne}from"./TabContainer-e6b87ac2.js";import oe from"./InvoiceLines-c51421c4.js";import{T as se}from"./TemplateEditor-5f1015af.js";import"./DataPage-3bb02e5e.js";import"./errors-53bc63a8.js";import"./DataForm-8f7f0e0d.js";const ce={class:"page-container"},ie={class:"heading"},le={key:0,class:"details-container"},ue={class:"field-label"},re={class:"field-value"},ve={key:0},de={key:1},me={__name:"ViewInvoice",setup(pe){const F=G(),k=J(),{isEmpty:w,notEmpty:C}=ae(),j=Q(),{flashMessage:v}=W(),q=X(),L=Object.assign({},F.currentRoute.value),T=m(()=>L.params.id),M=m(()=>L.query.contactId),{fieldsLayout:O,generateDataFields:R}=te(),D=m(()=>R(M.value)),{inputLabel:A,inputValue:$,includeKeys:E}=ee(D.value),a=u(),_=u(),y=u(),i=u(),S=u(),H=m(()=>a.value?`Invoice: ${a.value.invoiceNumber}`:"Loading Invoice...");async function V(){a.value=null;const e={include:E.value};await k.view("invoices",T.value,e).then(l=>{a.value=l,v("Loaded invoice successfully!")}).catch(l=>{console.error(l),v("Error loading invoice!")})}async function K(){_.value=null,y.value=null,i.value=null,k.view("invoices",a.value.id,{},{path:"template_data"}).then(e=>{_.value=e.invoiceLines,y.value=e.invoiceConfig,i.value=e.invoiceTemplate;const l=e.invoiceNumberSequence,f=e.currency,g=e.billingContact,s=e.country,d=e.logo;S.value={invoice:a.value,invoiceLines:_.value,invoiceConfig:y.value,invoiceNumberSequence:l,billingContact:Object.assign({},g,{country:s.countryName,logo:d.rawData}),currency:f,country:s,logo:d},v("Loaded template data successfully!")}).catch(e=>{console.error(e),v("Error loading template data!")})}const r=u(0),N=[{label:"Details",onchange:V},{label:"Invoice Lines",onchange:P},{label:"View Invoice PDF",onchange:K}];async function P(){j.emitEvent("loadData",{dataType:"Invoice Lines"})}async function U(e){await N[e].onchange(),r.value=e}return Y(async()=>{await V()}),(e,l)=>(n(),o("div",ce,[b("h2",ie,h(t(H)),1),a.value?c("",!0):(n(),p(t(Z),{key:0})),a.value?(n(),p(ne,{key:1,"selected-tab":r.value,tabs:N,onTabChange:U},{"tab-0":I(()=>[r.value===0?(n(),o("div",le,[(n(!0),o(x,null,B(t(O),(f,g)=>(n(),o("div",{key:g,class:"data-row"},[(n(!0),o(x,null,B(Object.keys(f),(s,d)=>(n(),o("div",{key:d,class:"data-field"},[b("div",ue,h(t(A)(s)),1),b("div",re,[t(C)(a.value)&&t(C)(a.value[s])?(n(),o("span",ve,h(t($)(s,a.value,t(E),t(D),t(q))),1)):c("",!0),t(w)(a.value)||t(w)(a.value[s])?(n(),o("span",de," --- no value --- ")):c("",!0)])]))),128))]))),128))])):c("",!0)]),"tab-1":I(()=>[r.value===1?(n(),p(oe,{key:0,"invoice-id":t(T)},null,8,["invoice-id"])):c("",!0)]),"tab-2":I(()=>[r.value===2&&i.value?(n(),p(se,{key:0,id:i.value.id,"template-type":"invoice_templates","content-markup":i.value.contentMarkup,"content-styles":i.value.contentStyles,data:S.value,disabled:!0},null,8,["id","content-markup","content-styles","data"])):c("",!0)]),_:1},8,["selected-tab"])):c("",!0)]))}},Le=z(me,[["__scopeId","data-v-9fbfff63"]]);export{Le as default};
