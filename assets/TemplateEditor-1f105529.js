import{_ as ce,m as de,a as re,L as ue,r as a,c as p,o as pe,b as f,d as M,i as t,j as O,s as h,A as E,g as l,t as v,e as y,f as P,x as fe,J as ve,$ as me,P as _e,T as he,K as ye,p as be,h as ke}from"./index-d462555e.js";import{u as ge}from"./validations-9a1af222.js";import{T as Ee}from"./TabContainer-2049c964.js";const o=s=>(be("data-v-47746345"),s=s(),ke(),s),Se={class:"preview-template"},we={class:"template-editor"},Ce=o(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),Te=[Ce],De=["contenteditable"],Me=o(()=>t("i",{class:"fa-solid fa-pencil"},null,-1)),Pe=[Me],xe=o(()=>t("i",{class:"fa-solid fa-check"},null,-1)),Ve=[xe],Ne={key:0,class:"error-message"},Re=o(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),Le=[Re],je=["contenteditable"],Be=o(()=>t("i",{class:"fa-solid fa-pencil"},null,-1)),Oe=[Be],Ae=o(()=>t("i",{class:"fa-solid fa-check"},null,-1)),Ge=[Ae],Ie={key:0,class:"error-message"},Fe=o(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),$e=[Fe],Je=["contenteditable"],Ue=o(()=>t("i",{class:"fa-solid fa-pencil"},null,-1)),qe=[Ue],He=o(()=>t("i",{class:"fa-solid fa-check"},null,-1)),ze=[He],Ke={class:"preview-container"},Qe=o(()=>t("h3",{class:"heading"}," Preview ",-1)),We=["innerHTML"],Xe={class:"buttons"},Ye=o(()=>t("div",{class:"message"}," Generating PDF... ",-1)),Ze={__name:"TemplateEditor",props:{id:{type:String,default:null},contentMarkup:{type:String,default:""},contentStyles:{type:String,default:""},disabled:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},enableGenerate:{type:Boolean,default:!0},templateType:{type:String,default:null}},emits:["contentMarkupChange","contentStylesChange","dataChange"],setup(s,{emit:S}){const n=s,w=de(),A=re(),{notEmpty:x}=ge(),G=new ue,I=a("style"),V=p(()=>({contentMarkup:n.contentMarkup,contentStyles:n.contentStyles})),N=a(0),F=[{label:"Markup"},{label:"Styles"},{label:"Data"}];function $(e){N.value=e}const C=a("markupEditor"),R=a("stylesEditor"),T=a("sampleDataEditor"),d=a(!1),r=a(!1),u=a(!1),J=p(()=>{const e=[];return e.push("editor"),d.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")}),U=p(()=>{const e=[];return e.push("editor"),r.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")}),q=p(()=>{const e=[];return e.push("editor"),u.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")});function H(){d.value=!0}async function z(){_.value=!1,await D().then(e=>{te()}).catch(e=>{_.value=!0,m.value="Markup error",console.log(e)}).finally(()=>{d.value=!1})}function K(){r.value=!0}function Q(){ae(),r.value=!1}function W(){u.value=!0}async function X(){_.value=!1,await D().then(e=>{se()}).catch(e=>{_.value=!0,m.value="Sample data error",console.log(e)}).finally(()=>{u.value=!1})}function Y(){d.value=!d.value}function Z(){r.value=!r.value}function ee(){u.value=!u.value}function te(){S("contentMarkupChange",C.value.innerText)}function ae(){S("contentStylesChange",R.value.innerText)}function se(){const e=T.value.innerText;x(e)&&S("dataChange",JSON.parse(e))}const L=p(()=>n.data),ne=p(()=>_.value?"preview-content error":"preview-content"),m=a(),_=a(!1);async function D(){return new Promise((e,i)=>{m.value=null;const c=T.value.innerText;x(c)?G.parseAndRender(C.value.innerText,JSON.parse(c)).then(g=>{m.value=g,e(g)}).catch(g=>{i(g)}):e()})}const b=a(!1),k=a(),j=a(),B=a();async function oe(){k.value=null,b.value=!0,await A.downloadStream(n.templateType,n.id,L.value,{path:"pdf"}).then(e=>{const i=new Blob([e.data],{type:"application/pdf"}),c=window.URL.createObjectURL(i);j.value=c,B.value=`${n.templateType}_${n.id}.pdf`,k.value=c,le()}).catch(e=>{console.log(e)}).finally(()=>{ie()})}function le(){const e=Object.assign({},w.currentRoute.value),i={path:"/document_templates/:templateType/:id/pdf",name:"View Pdf",component:()=>ye(()=>import("./PdfViewer-99d296f7.js"),["assets/PdfViewer-99d296f7.js","assets/index-d462555e.js","assets/index-3b980fb9.css","assets/PdfViewer-652058bc.css"]),props:{templatePdfData:k.value,downloadLink:j.value,downloadFile:B.value},meta:{parentRoute:{name:e.name},hidden:!0}};w.addRoute(i),w.push({name:"View Pdf",params:{templateType:n.templateType,id:n.id}})}function ie(){b.value=!1}return pe(async()=>{await D()}),(e,i)=>(f(),M("div",Se,[t("div",we,[O(Ee,{"selected-tab":N.value,tabs:F,onTabChange:$},{"tab-0":h(()=>[t("div",{class:E(l(J))},[t("div",{class:"editor-button cancel",onClick:Y},Te),t("div",{ref_key:"markupEditor",ref:C,class:"editor-content",contenteditable:d.value},v(l(V).contentMarkup),9,De),t("div",{class:"editor-button edit",onClick:H},Pe),t("div",{class:"editor-button confirm",onClick:z},Ve)],2),s.errorMessages.contentMarkup?(f(),M("div",Ne,v(s.errorMessages.contentMarkup),1)):y("",!0)]),"tab-1":h(()=>[t("div",{class:E(l(U))},[t("div",{class:"editor-button cancel",onClick:Z},Le),t("div",{ref_key:"stylesEditor",ref:R,class:"editor-content",contenteditable:r.value},v(l(V).contentStyles),9,je),t("div",{class:"editor-button edit",onClick:K},Oe),t("div",{class:"editor-button confirm",onClick:Q},Ge)],2),s.errorMessages.contentStyles?(f(),M("div",Ie,v(s.errorMessages.contentStyles),1)):y("",!0)]),"tab-2":h(()=>[t("div",{class:E(l(q))},[t("div",{class:"editor-button cancel",onClick:ee},$e),t("div",{ref_key:"sampleDataEditor",ref:T,class:"editor-content",contenteditable:u.value},v(l(L)),9,Je),t("div",{class:"editor-button edit",onClick:W},qe),t("div",{class:"editor-button confirm",onClick:X},ze)],2)]),_:1},8,["selected-tab"])]),t("div",Ke,[Qe,t("div",{class:E(l(ne)),innerHTML:m.value},null,10,We),s.contentStyles?(f(),P(ve(I.value),{key:0},{default:h(()=>[fe(v(s.contentStyles),1)]),_:1})):y("",!0),t("div",Xe,[s.enableGenerate?(f(),P(l(me),{key:0,value:"Generate",icon:"fa-solid fa-file-export",onClick:oe})):y("",!0)])]),O(l(he),{modelValue:b.value,"onUpdate:modelValue":i[0]||(i[0]=c=>b.value=c),class:"generate-dialog",title:"Generating PDF",width:400,height:250},{body:h(()=>[k.value?y("",!0):(f(),P(l(_e),{key:0})),Ye]),_:1},8,["modelValue"])]))}},st=ce(Ze,[["__scopeId","data-v-47746345"]]);export{st as T};
