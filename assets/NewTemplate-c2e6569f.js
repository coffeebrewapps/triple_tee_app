import{_ as U,j,u as q,r as d,c,o as P,a as m,b as g,h as C,n as L,t as O,f as l,d as T,i as b,q as F,W,e as Y,S as G,Y as z}from"./index-cf9ea608.js";import{a as $}from"./dataAccess-238ee380.js";import{u as H}from"./errors-a6177d44.js";import{T as J}from"./TemplateEditor-6719ac54.js";import"./TabContainer-bd4cd668.js";const K={class:"page-container"},Q={class:"heading"},X={class:"name"},ee={key:1,class:"actions"},te={__name:"NewTemplate",props:{disabled:{type:Boolean,default:!1}},setup(k){const _=j(),p=$(),S=H(),h=q(),v=d({}),A=Object.assign({},_.currentRoute.value),u=c(()=>{if(a.value)return a.value.id}),f=c({get:()=>a.value.name,set:e=>{a.value.name=e}}),s=c(()=>A.params.templateType),N=c(()=>s.value==="invoice_templates"?"Create Invoice Template":"Create Receipt Template"),a=d({name:null,contentMarkup:null,contentStyles:null}),i=d(!1),r=d({});function M(e){return Object.entries(e).reduce((t,[n,x])=>(t[n]=x.map(R=>({name:R,params:{}})),t),{})}function y(e){return r.value[e]?r.value[e].map(t=>S[t.name](t.params)).join(", "):""}const Z=c(()=>{const e={};return r.value.contentMarkup&&(e.contentMarkup=y("contentMarkup")),r.value.contentStyles&&(e.contentStyles=y("contentStyles")),e});async function V(e){if(!u.value){a.value.contentMarkup=e;return}const t=Object.assign({},a.value,{contentMarkup:e});await p.update(s.value,u.value,t).then(n=>{a.value=n,o("Updated markup successfully!")}).catch(n=>{o("Error updating markup!")})}async function D(e){if(!u.value){a.value.contentStyles=e;return}const t=Object.assign({},a.value,{contentStyles:e});await p.update(s.value,u.value,t).then(n=>{a.value=n,o("Updated styles successfully!")}).catch(n=>{o("Error updating styles !")})}function E(e){v.value=e}function I(){i.value=!i.value}function o(e){h.show(e),setTimeout(B,5e3)}function B(){h.hide()}async function w(){const e={name:a.value.name,contentMarkup:a.value.contentMarkup,contentStyles:a.value.contentStyles};await p.create(s.value,e).then(t=>{a.value=t,o("Template created successfully!")}).catch(t=>{o("Error creating template!"),r.value=M(t),console.log(t)})}return P(async()=>{v.value={invoice:{invoiceNumber:2,invoiceDate:"2023-05-26T14:06:15.686Z",dueDate:"2023-06-25T14:06:15.686Z",totalAmount:574.98},invoiceLines:[{id:"1",description:"Requirements gathering",unit:"hour",unitCost:100,unitValue:2.06,subtotal:205.93,invoiceId:"1",createdAt:"2023-05-26T14:07:10.051Z",updatedAt:"2023-05-26T14:07:10.051Z"},{id:"2",description:"Implementation",unit:"hour",unitCost:85,unitValue:4.17,subtotal:354.05,invoiceId:"1",createdAt:"2023-05-26T14:07:10.055Z",updatedAt:"2023-05-26T14:07:10.055Z"},{id:"3",description:"GST",unit:"fixed",unitCost:15,unitValue:1,subtotal:15,invoiceId:"1",createdAt:"2023-05-26T14:07:10.057Z",updatedAt:"2023-05-26T14:07:10.057Z"}],invoiceConfig:{id:"1",invoiceCycleDurationValue:1,invoiceCycleDurationUnit:"month",dueDateCycleValue:30,dueDateCycleUnit:"day",paymentTerms:"Payment due to account 395-17573-542",tags:["1"],customFields:{},invoiceNumberSequenceId:"1",billingContactId:"1",invoiceTemplateId:"1",currencyId:"1",createdAt:"2023-05-26T06:32:33.830Z",updatedAt:"2023-05-26T06:32:33.830Z"},invoiceNumberSequence:{id:"1",name:"Company ABC Invoice Sequence",startingNumber:1,lastUsedNumber:1,incrementStep:1,prefix:"INV",suffix:"ABC",createdAt:"2023-05-26T06:30:04.445Z",updatedAt:"2023-05-26T06:30:04.445Z"},billingContact:{id:"1",name:"Company ABC",accountNumber:null,addressLine1:null,addressLine2:null,addressLine3:null,city:null,state:null,country:"SGP",postcode:null,contactNumber1:null,contactNumber2:null,contactNumber3:null,contactPerson1:null,contactPerson2:null,contactPerson3:null,contactEmail1:null,contactEmail2:null,contactEmail3:null,url1:null,url2:null,url3:null,logo:null,customFields:null,createdAt:"2023-05-26T06:30:24.570Z",updatedAt:"2023-05-26T06:30:24.570Z"},currency:{id:"1",code:"USD",symbol:"$",exchangeRate:1,effectiveStart:"2012-12-31T16:00:00.000Z",effectiveEnd:null,createdAt:"2023-05-26T06:29:49.052Z",updatedAt:"2023-05-26T06:29:49.052Z"}}}),(e,t)=>(m(),g("div",K,[C("h2",Q,[L(O(l(N))+" ",1),l(u)?T("",!0):(m(),g("i",{key:0,class:"fa-solid fa-circle-exclamation",onClick:I}))]),C("div",X,[b(l(W),{modelValue:l(f),"onUpdate:modelValue":t[0]||(t[0]=n=>F(f)?f.value=n:null),label:"Template Name",size:"lg","error-message":y("name")},null,8,["modelValue","error-message"])]),a.value?(m(),Y(J,{key:0,"template-type":l(s),id:a.value.id,"content-markup":a.value.contentMarkup,"content-styles":a.value.contentStyles,data:v.value,disabled:k.disabled,"enable-generate":!1,"error-messages":l(Z),onContentMarkupChange:V,onContentStylesChange:D,onDataChange:E},null,8,["template-type","id","content-markup","content-styles","data","disabled","error-messages"])):T("",!0),l(u)?T("",!0):(m(),g("div",ee,[b(l(G),{value:"Create Template",icon:"fa-solid fa-check",onClick:w})])),b(l(z),{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=n=>i.value=n),title:"Reminder",content:"You have not saved your template. Make sure to click on Create Template to submit the changes.",width:600,height:250},null,8,["modelValue"])]))}},se=U(te,[["__scopeId","data-v-2386ebd8"]]);export{se as default};
