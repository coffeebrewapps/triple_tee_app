import{_ as $,j as H,k as K,u as P,c as d,r as u,o as U,a as t,b as c,h as m,t as h,f as o,e as b,Z as z,d as r,l as f,F as V,m as B,i as G}from"./index-cf9ea608.js";import{u as J}from"./Form-6ecdf185.js";import{a as Q}from"./dataAccess-238ee380.js";import{T as W}from"./TabContainer-bd4cd668.js";import X from"./InvoiceLines-ca678ef6.js";import{T as Y}from"./TemplateEditor-6719ac54.js";import{u as ee}from"./utils-47eab738.js";import"./errors-a6177d44.js";import"./DataPage-a796708b.js";const ne={class:"page-container"},ae={class:"heading"},te={class:"details-container"},oe={class:"data-row"},ce={class:"data-field"},ie={class:"field-label"},se={class:"field-value"},le={key:0},ue={key:1},re={__name:"ViewInvoice",setup(ve){const E=H(),y=Q(),N=K(),I=P(),g=Object.assign({},E.currentRoute.value),k=d(()=>g.params.id),S=d(()=>g.query.contactId),{fieldsLayout:x,generateDataFields:F}=ee(),w=d(()=>F(S.value)),{inputLabel:q,inputValue:j,includeKeys:L}=J(w.value),e=u(),p=u(),n=u(),i=u(),T=u(),R=d(()=>e.value?`Invoice: ${e.value.invoiceNumber}`:"Loading Invoice...");async function C(){e.value=null;const a={include:L.value};await y.view("invoices",k.value,a).then(s=>{e.value=s,v("Loaded invoice successfully!")}).catch(s=>{console.error(s),v("Error loading invoice!")})}async function A(){p.value=null,n.value=null,i.value=null,y.view("invoices",e.value.id,{},{path:"template_data"}).then(a=>{p.value=a.invoiceLines,n.value=a.invoiceConfig,i.value=n.value.includes.invoiceTemplateId[n.value.invoiceTemplateId];const s=n.value.includes.invoiceNumberSequenceId[n.value.invoiceNumberSequenceId],_=n.value.includes.billingContactId[n.value.billingContactId],l=n.value.includes.currencyId[n.value.currencyId];T.value={invoice:e.value,invoiceLines:p.value,invoiceConfig:n.value,invoiceNumberSequence:s,billingContact:_,currency:l},v("Loaded template data successfully!")}).catch(a=>{console.error(a),v("Error loading template data!")})}function v(a){I.show(a),setTimeout(M,5e3)}function M(){I.hide()}const D=[{label:"Details",onchange:C},{label:"Invoice Lines",onchange:O},{label:"View Invoice PDF",onchange:A}];async function O(){N.emitEvent("loadData",{dataType:"Invoice Lines"})}function Z(a){D[a].onchange()}return U(async()=>{await C()}),(a,s)=>(t(),c("div",ne,[m("h2",ae,h(o(R)),1),e.value?r("",!0):(t(),b(o(z),{key:0})),e.value?(t(),b(W,{key:1,tabs:D,onTabChange:Z},{"tab-0":f(()=>[m("div",te,[(t(!0),c(V,null,B(o(x),_=>(t(),c("div",oe,[(t(!0),c(V,null,B(Object.keys(_),l=>(t(),c("div",ce,[m("div",ie,h(o(q)(l)),1),m("div",se,[e.value&&e.value[l]?(t(),c("span",le,h(o(j)(l,e.value,o(L),o(w))),1)):r("",!0),!e.value||!e.value[l]?(t(),c("span",ue," --- no value --- ")):r("",!0)])]))),256))]))),256))])]),"tab-1":f(()=>[G(X,{"invoice-id":o(k)},null,8,["invoice-id"])]),"tab-2":f(()=>[i.value?(t(),b(Y,{key:0,"template-type":"invoice_templates",id:i.value.id,"content-markup":i.value.contentMarkup,"content-styles":i.value.contentStyles,data:T.value,disabled:!0},null,8,["id","content-markup","content-styles","data"])):r("",!0)]),_:1})):r("",!0)]))}},ge=$(re,[["__scopeId","data-v-38ebd715"]]);export{ge as default};
