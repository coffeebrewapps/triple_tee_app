import{_ as ce,q as de,a as re,L as ue,r as a,c as p,o as pe,b as f,d as M,i as t,j as O,x as h,D as E,g as l,t as v,e as y,f as x,z as fe,M as ve,I as me,v as _e,N as he,O as ye,p as be,h as ke}from"./index-927a7567.js";import{u as ge}from"./validations-9a1af222.js";import{T as Ee}from"./TabContainer-e2746697.js";const o=s=>(be("data-v-47746345"),s=s(),ke(),s),Se={class:"preview-template"},we={class:"template-editor"},Ce=o(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),Te=[Ce],De=["contenteditable"],Me=o(()=>t("i",{class:"fa-solid fa-pencil"},null,-1)),xe=[Me],Pe=o(()=>t("i",{class:"fa-solid fa-check"},null,-1)),Ne=[Pe],Ve={key:0,class:"error-message"},Re=o(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),Le=[Re],je=["contenteditable"],Be=o(()=>t("i",{class:"fa-solid fa-pencil"},null,-1)),Oe=[Be],Ie=o(()=>t("i",{class:"fa-solid fa-check"},null,-1)),Ge=[Ie],Ae={key:0,class:"error-message"},Fe=o(()=>t("i",{class:"fa-solid fa-xmark"},null,-1)),qe=[Fe],Ue=["contenteditable"],ze=o(()=>t("i",{class:"fa-solid fa-pencil"},null,-1)),He=[ze],Je=o(()=>t("i",{class:"fa-solid fa-check"},null,-1)),$e=[Je],Ke={class:"preview-container"},Qe=o(()=>t("h3",{class:"heading"}," Preview ",-1)),We=["innerHTML"],Xe={class:"buttons"},Ye=o(()=>t("div",{class:"message"}," Generating PDF... ",-1)),Ze={__name:"TemplateEditor",props:{id:{type:String,default:null},contentMarkup:{type:String,default:""},contentStyles:{type:String,default:""},disabled:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},enableGenerate:{type:Boolean,default:!0},templateType:{type:String,default:null}},emits:["contentMarkupChange","contentStylesChange","dataChange"],setup(s,{emit:S}){const n=s,w=de(),I=re(),{notEmpty:P}=ge(),G=new ue,A=a("style"),N=p(()=>({contentMarkup:n.contentMarkup,contentStyles:n.contentStyles})),V=a(0),F=[{label:"Markup"},{label:"Styles"},{label:"Data"}];function q(e){V.value=e}const C=a("markupEditor"),R=a("stylesEditor"),T=a("sampleDataEditor"),d=a(!1),r=a(!1),u=a(!1),U=p(()=>{const e=[];return e.push("editor"),d.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")}),z=p(()=>{const e=[];return e.push("editor"),r.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")}),H=p(()=>{const e=[];return e.push("editor"),u.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")});function J(){d.value=!0}async function $(){_.value=!1,await D().then(e=>{te()}).catch(e=>{_.value=!0,m.value="Markup error",console.log(e)}).finally(()=>{d.value=!1})}function K(){r.value=!0}function Q(){ae(),r.value=!1}function W(){u.value=!0}async function X(){_.value=!1,await D().then(e=>{se()}).catch(e=>{_.value=!0,m.value="Sample data error",console.log(e)}).finally(()=>{u.value=!1})}function Y(){d.value=!d.value}function Z(){r.value=!r.value}function ee(){u.value=!u.value}function te(){S("contentMarkupChange",C.value.innerText)}function ae(){S("contentStylesChange",R.value.innerText)}function se(){const e=T.value.innerText;P(e)&&S("dataChange",JSON.parse(e))}const L=p(()=>n.data),ne=p(()=>_.value?"preview-content error":"preview-content"),m=a(),_=a(!1);async function D(){return new Promise((e,i)=>{m.value=null;const c=T.value.innerText;P(c)?G.parseAndRender(C.value.innerText,JSON.parse(c)).then(g=>{m.value=g,e(g)}).catch(g=>{i(g)}):e()})}const b=a(!1),k=a(),j=a(),B=a();async function oe(){k.value=null,b.value=!0,await I.downloadStream(n.templateType,n.id,L.value,{path:"pdf"}).then(e=>{const i=new Blob([e.data],{type:"application/pdf"}),c=window.URL.createObjectURL(i);j.value=c,B.value=`${n.templateType}_${n.id}.pdf`,k.value=c,le()}).catch(e=>{console.log(e)}).finally(()=>{ie()})}function le(){const e=Object.assign({},w.currentRoute.value),i={path:"/document_templates/:templateType/:id/pdf",name:"View Pdf",component:()=>ye(()=>import("./PdfViewer-ecdae283.js"),["assets/PdfViewer-ecdae283.js","assets/index-927a7567.js","assets/index-1309efc1.css","assets/PdfViewer-652058bc.css"]),props:{templatePdfData:k.value,downloadLink:j.value,downloadFile:B.value},meta:{parentRoute:{name:e.name},hidden:!0}};w.addRoute(i),w.push({name:"View Pdf",params:{templateType:n.templateType,id:n.id}})}function ie(){b.value=!1}return pe(async()=>{await D()}),(e,i)=>(f(),M("div",Se,[t("div",we,[O(Ee,{"selected-tab":V.value,tabs:F,onTabChange:q},{"tab-0":h(()=>[t("div",{class:E(l(U))},[t("div",{class:"editor-button cancel",onClick:Y},Te),t("div",{ref_key:"markupEditor",ref:C,class:"editor-content",contenteditable:d.value},v(l(N).contentMarkup),9,De),t("div",{class:"editor-button edit",onClick:J},xe),t("div",{class:"editor-button confirm",onClick:$},Ne)],2),s.errorMessages.contentMarkup?(f(),M("div",Ve,v(s.errorMessages.contentMarkup),1)):y("",!0)]),"tab-1":h(()=>[t("div",{class:E(l(z))},[t("div",{class:"editor-button cancel",onClick:Z},Le),t("div",{ref_key:"stylesEditor",ref:R,class:"editor-content",contenteditable:r.value},v(l(N).contentStyles),9,je),t("div",{class:"editor-button edit",onClick:K},Oe),t("div",{class:"editor-button confirm",onClick:Q},Ge)],2),s.errorMessages.contentStyles?(f(),M("div",Ae,v(s.errorMessages.contentStyles),1)):y("",!0)]),"tab-2":h(()=>[t("div",{class:E(l(H))},[t("div",{class:"editor-button cancel",onClick:ee},qe),t("div",{ref_key:"sampleDataEditor",ref:T,class:"editor-content",contenteditable:u.value},v(l(L)),9,Ue),t("div",{class:"editor-button edit",onClick:W},He),t("div",{class:"editor-button confirm",onClick:X},$e)],2)]),_:1},8,["selected-tab"])]),t("div",Ke,[Qe,t("div",{class:E(l(ne)),innerHTML:m.value},null,10,We),s.contentStyles?(f(),x(ve(A.value),{key:0},{default:h(()=>[fe(v(s.contentStyles),1)]),_:1})):y("",!0),t("div",Xe,[s.enableGenerate?(f(),x(l(me),{key:0,value:"Generate",icon:"fa-solid fa-file-export",onClick:oe})):y("",!0)])]),O(l(he),{modelValue:b.value,"onUpdate:modelValue":i[0]||(i[0]=c=>b.value=c),class:"generate-dialog",title:"Generating PDF",width:400,height:250},{body:h(()=>[k.value?y("",!0):(f(),x(l(_e),{key:0})),Ye]),_:1},8,["modelValue"])]))}},st=ce(Ze,[["__scopeId","data-v-47746345"]]);export{st as T};
