import{_ as O,a as D,u as k,r as n,w as J,c as g,o as U,b as _,d as A,j as p,g as i,f as B,e as E,k as C,y as I,l as L,B as $,p as M,h as j,i as F}from"./index-f8b7dd22.js";const z=v=>(M("data-v-be791ab4"),v=v(),j(),v),T={class:"page-container"},q=z(()=>F("h2",{class:"heading"}," Data Admin ",-1)),G={__name:"DataAdmin",setup(v){const f=D(),{flashMessage:l}=k(),t=n();J(t,async(e,a)=>{await h()});const o=n(!0),b=g(()=>`Data (Total: ${Object.keys(u.value).length})`),u=n([]),d=n(""),c=n(""),r=n(!1),S=[{value:"indexes",label:"Indexes"}],m=n([]),V=g(()=>S.concat(m.value));async function w(){await f.schemas().then(e=>{m.value=e.map(a=>({value:a,label:a})),l("Loaded model class options successfully!")}).catch(e=>{r.value=!0,c.value=JSON.stringify(e,!1,4),l("Error loading model class options!")})}async function h(){u.value=[],t.value&&(o.value=!0,await f.list(t.value).then(e=>{u.value=e.data,d.value=JSON.stringify(u.value,!1,4),l(`Fetched ${t.value} successfully!`)}).catch(e=>{r.value=!0,c.value=JSON.stringify(e,!1,4),l(`Error fetching ${t.value} data!`)}).finally(()=>{o.value=!1}))}function x(e){return JSON.parse(e).reduce((a,s)=>{const y=Object.assign({},s);return delete y.includes,a[s.id]=y,a},{})}async function N(){o.value=!0,t.value==="indexes"?await f.upload("indexes",JSON.parse(d.value)).then(e=>{u.value=e.data,d.value=JSON.stringify(u.value,!1,4),l("Updated indexes successfully!")}).catch(e=>{r.value=!0,c.value=JSON.stringify(e,!1,4),l("Error updating indexes!")}).finally(()=>{o.value=!1}):await f.upload(t.value,x(d.value)).then(e=>{l(`Updated ${t.value} data successfully!`),h()}).catch(e=>{r.value=!0,c.value=JSON.stringify(e,!1,4),l(`Error updating ${t.value} data!`)}).finally(()=>{o.value=!1})}return U(async()=>{await w()}),(e,a)=>(_(),A("div",T,[q,p(i(C),{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=s=>t.value=s),label:"Model Class",name:"model-class",options:i(V),size:"lg"},null,8,["modelValue","options"]),p(i(I),{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=s=>d.value=s),label:i(b),rows:30,cols:150,disabled:o.value},null,8,["modelValue","label","disabled"]),c.value.length>0?(_(),B(i(L),{key:0,modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=s=>r.value=s),title:"Error",class:"error-alert",content:c.value,width:800,height:500},null,8,["modelValue","content"])):E("",!0),p(i($),{"button-type":"text",value:"Update",icon:"fa-solid fa-check",onClick:N})]))}},K=O(G,[["__scopeId","data-v-be791ab4"]]);export{K as default};
