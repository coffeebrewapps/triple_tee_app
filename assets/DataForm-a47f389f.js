import{u as he}from"./input-33a9bda4.js";import{u as Ue}from"./errors-74d0bde9.js";import{u as ke}from"./validations-83886343.js";import{_ as Fe,c as O,r as h,o as De,b as r,d as v,i as T,F as x,x as S,G as Ce,C as w,f as d,g as t,A as I,e as m,k as Oe,W as Te,S as Be,s as ze,T as _,U as Me,V as je,Y as $,j as B,$ as xe,M as L}from"./index-196d7642.js";const Se={class:"body"},we={class:"field-input"},Ie={key:0,class:"field-toggle"},_e={key:0,class:"actions"},$e={__name:"DataForm",props:{modelValue:{type:Object,default(){return{}}},fieldsLayout:{type:Array,default(){return[]}},dataFields:{type:Array,default(){return[]}},schemas:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},compact:{type:Boolean,default:!1},submittable:{type:Boolean,default:!0},confirmButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-check",value:"Confirm"}}},cancelButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-xmark",value:"Cancel"}}}},emits:["update:modelValue","submit","cancel"],setup(y,{emit:U}){const V=y,n=O({get:()=>V.modelValue,set:a=>{U("update:modelValue",a)}}),E=h({}),{schemasMap:z,serverOptionsFields:A,inputType:b,inputLabel:u,inputableField:N,multiInputableField:P,multiSelectableField:R,singleSelectableField:H,nullToggleableField:k,nullToggleableFields:W,objectField:G,fileField:Y,formatInputOptionsData:q,fetchOptions:J,initOptionsData:K}=he(V.schemas),{notEmpty:Q}=ke(),X=Ue(),F=h(W.value.reduce((a,o)=>(a[o]=!1,a),{}));function c(a){return!k(a)||F.value[a]}function Z(a){return c(a)&&N(a)}function f(a){return c(a)&&Y(a)}function ee(a){const o=u(a);return Q(n.value[a])?`${o} (Existing: ${n.value[a]})`:o}function ae(a){return c(a)&&(P(a)||G(a))}function te(a){return c(a)&&b(a)==="date"}function ne(a){return c(a)&&b(a)==="datetime"}function oe(a){return c(a)&&(b(a)==="enum"||b(a)==="select")}function se(a){return c(a)&&b(a)==="daterange"}function re(a){return c(a)&&b(a)==="datetimerange"}function le(a){return c(a)&&b(a)==="boolean"}function i(a){return V.dataFields.find(o=>o===a)}function ue(a){return`Has ${u(a)}`}function p(a){return!V.errorMessages||!V.errorMessages[a]?"":V.errorMessages[a].map(o=>X[o.name](o.params)).join(", ")}const M=h({});function me(a,o){const l=a.target.files[0];M.value[o]=l}const D=h({});function g(a){return D.value[a]}function ce(a){return c(a)&&H(a)&&!!g(a)}function ie(a){return c(a)&&R(a)&&!!g(a)}const j=O(()=>A.value.reduce((a,o)=>(a[o]=l=>{pe(o,l)},a),{}));async function pe(a,o){const l=z.value[a].limit||5;await J(a,o).then(C=>{D.value[a]=q(a,o,l,C)})}const de=O(()=>V.compact?"form compact":"form");function be(a){return k(a)?"data-field toggleable":"data-field"}function ge(){return Object.entries(n.value).reduce((a,[o,l])=>(b(o)==="file"?a[o]=M.value[o]:a[o]=l,a),{})}function ye(){const a=ge();U("submit",a)}function Ve(){U("cancel")}return De(async()=>{E.value=V.modelValue,await K().then(a=>{D.value=a}).catch(a=>{console.error(a)})}),(a,o)=>(r(),v("div",{class:w(t(de))},[T("div",Se,[(r(!0),v(x,null,S(y.fieldsLayout,(l,C)=>(r(),v("div",{key:C,class:"data-row"},[(r(!0),v(x,null,S(Object.keys(l),(e,ve)=>Ce(a.$slots,`form-col.${e}`,xe({key:ve},{field:e,type:t(b)(e),label:t(u)(e)}),()=>[T("div",{class:w(be(e))},[T("div",we,[Z(e)?(r(),d(t(I),{key:0,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,type:t(b)(e),label:t(u)(e),size:l[e],disabled:!i(e),"error-message":p(e)},null,8,["modelValue","onUpdate:modelValue","type","label","size","disabled","error-message"])):m("",!0),f(e)?(r(),d(t(I),{key:1,ref_for:!0,ref:"fileRefs",type:"file",label:ee(e),size:l[e],disabled:!i(e),"error-message":p(e),onChange:s=>me(s,e)},null,8,["label","size","disabled","error-message","onChange"])):m("",!0),ae(e)?(r(),d(t(Oe),{key:2,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),disabled:!i(e),"error-message":p(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0),te(e)?(r(),d(t(Te),{key:3,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),disabled:!i(e),"align-pickers":"top","error-message":p(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0),ne(e)?(r(),d(t(Be),{key:4,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),disabled:!i(e),"display-time":!0,"align-pickers":"top","error-message":p(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0),oe(e)?(r(),d(t(ze),{key:5,id:e,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),name:e,options:t(z)[e].options,size:l[e],disabled:!i(e),"error-message":p(e)},null,8,["id","modelValue","onUpdate:modelValue","label","name","options","size","disabled","error-message"])):m("",!0),ce(e)?(r(),d(t(_),{key:6,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),name:t(u)(e),multiple:!1,options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:l[e],disabled:!i(e),"error-message":p(e),onOffsetChange:t(j)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):m("",!0),ie(e)?(r(),d(t(_),{key:7,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),name:t(u)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:l[e],disabled:!i(e),"error-message":p(e),onOffsetChange:t(j)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):m("",!0),se(e)?(r(),d(t(Me),{key:8,"start-date":t(n)[e].startDate,"onUpdate:startDate":s=>t(n)[e].startDate=s,"end-date":t(n)[e].endDate,"onUpdate:endDate":s=>t(n)[e].endDate=s,label:t(u)(e),disabled:!i(e),"error-message":p(e)},null,8,["start-date","onUpdate:startDate","end-date","onUpdate:endDate","label","disabled","error-message"])):m("",!0),re(e)?(r(),d(t(je),{key:9,"start-time":t(n)[e].startTime,"onUpdate:startTime":s=>t(n)[e].startTime=s,"end-time":t(n)[e].endTime,"onUpdate:endTime":s=>t(n)[e].endTime=s,label:t(u)(e),disabled:!i(e),"error-message":p(e)},null,8,["start-time","onUpdate:startTime","end-time","onUpdate:endTime","label","disabled","error-message"])):m("",!0),le(e)?(r(),d(t($),{key:10,modelValue:t(n)[e],"onUpdate:modelValue":s=>t(n)[e]=s,label:t(u)(e),disabled:!i(e),"error-message":p(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):m("",!0)]),t(k)(e)?(r(),v("div",Ie,[B(t($),{modelValue:F.value[e],"onUpdate:modelValue":s=>F.value[e]=s,label:ue(e)},null,8,["modelValue","onUpdate:modelValue","label"])])):m("",!0)],2)],!0)),128))]))),128))]),y.submittable?(r(),v("div",_e,[B(t(L),{class:"button","button-type":y.confirmButton.type,value:y.confirmButton.value,icon:y.confirmButton.icon,onClick:o[0]||(o[0]=l=>ye())},null,8,["button-type","value","icon"]),B(t(L),{class:"button","button-type":y.cancelButton.type,value:y.cancelButton.value,icon:y.cancelButton.icon,onClick:o[1]||(o[1]=l=>Ve())},null,8,["button-type","value","icon"])])):m("",!0)],2))}},Pe=Fe($e,[["__scopeId","data-v-e12f1171"]]);export{Pe as D};
