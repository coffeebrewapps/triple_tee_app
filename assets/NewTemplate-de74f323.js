import{_ as q,j as P,u as L,r as d,c as r,o as O,a as m,b as g,h as C,n as F,t as W,f as l,d as T,i as h,q as Y,W as $,e as G,S as z,Y as H}from"./index-7f6b454a.js";import{u as J,a as K}from"./dataAccess-5c645c6d.js";import{u as Q}from"./errors-a6177d44.js";import{T as X}from"./TemplateEditor-7d1e9c58.js";import"./TabContainer-47d05ef3.js";const ee={class:"page-container"},te={class:"heading"},ae={class:"name"},ne={key:1,class:"actions"},le={__name:"NewTemplate",props:{disabled:{type:Boolean,default:!1}},setup(k){const _=P(),S=J(),p=K(),A=Q(),b=L(),v=d({}),N=Object.assign({},_.currentRoute.value),u=r(()=>{if(a.value)return a.value.id}),f=r({get:()=>a.value.name,set:e=>{a.value.name=e}}),o=r(()=>N.params.templateType),M=r(()=>o.value==="invoice_templates"?"Create Invoice Template":"Create Receipt Template"),Z=r(()=>`${S.baseUrl}/api/${o.value}`),a=d({name:null,contentMarkup:null,contentStyles:null}),i=d(!1),c=d({});function V(e){return Object.entries(e).reduce((t,[n,R])=>(t[n]=R.map(j=>({name:j,params:{}})),t),{})}function y(e){return c.value[e]?c.value[e].map(t=>A[t.name](t.params)).join(", "):""}const D=r(()=>{const e={};return c.value.contentMarkup&&(e.contentMarkup=y("contentMarkup")),c.value.contentStyles&&(e.contentStyles=y("contentStyles")),e});async function E(e){if(!u.value){a.value.contentMarkup=e;return}const t=Object.assign({},a.value,{contentMarkup:e});await p.update(o.value,u.value,t).then(n=>{a.value=n,s("Updated markup successfully!")}).catch(n=>{s("Error updating markup!")})}async function I(e){if(!u.value){a.value.contentStyles=e;return}const t=Object.assign({},a.value,{contentStyles:e});await p.update(o.value,u.value,t).then(n=>{a.value=n,s("Updated styles successfully!")}).catch(n=>{s("Error updating styles !")})}function B(e){v.value=e}function w(){i.value=!i.value}function s(e){b.show(e),setTimeout(x,5e3)}function x(){b.hide()}async function U(){const e={name:a.value.name,contentMarkup:a.value.contentMarkup,contentStyles:a.value.contentStyles};await p.create(o.value,e).then(t=>{a.value=t,s("Template created successfully!")}).catch(t=>{s("Error creating template!"),c.value=V(t),console.log(t)})}return O(async()=>{v.value={invoice:{invoiceNumber:2,invoiceDate:"2023-05-26T14:06:15.686Z",dueDate:"2023-06-25T14:06:15.686Z",totalAmount:574.98},invoiceLines:[{id:"1",description:"Requirements gathering",unit:"hour",unitCost:100,unitValue:2.06,subtotal:205.93,invoiceId:"1",createdAt:"2023-05-26T14:07:10.051Z",updatedAt:"2023-05-26T14:07:10.051Z"},{id:"2",description:"Implementation",unit:"hour",unitCost:85,unitValue:4.17,subtotal:354.05,invoiceId:"1",createdAt:"2023-05-26T14:07:10.055Z",updatedAt:"2023-05-26T14:07:10.055Z"},{id:"3",description:"GST",unit:"fixed",unitCost:15,unitValue:1,subtotal:15,invoiceId:"1",createdAt:"2023-05-26T14:07:10.057Z",updatedAt:"2023-05-26T14:07:10.057Z"}],invoiceConfig:{id:"1",invoiceCycleDurationValue:1,invoiceCycleDurationUnit:"month",dueDateCycleValue:30,dueDateCycleUnit:"day",paymentTerms:"Payment due to account 395-17573-542",tags:["1"],customFields:{},invoiceNumberSequenceId:"1",billingContactId:"1",invoiceTemplateId:"1",currencyId:"1",createdAt:"2023-05-26T06:32:33.830Z",updatedAt:"2023-05-26T06:32:33.830Z"},invoiceNumberSequence:{id:"1",name:"Company ABC Invoice Sequence",startingNumber:1,lastUsedNumber:1,incrementStep:1,prefix:"INV",suffix:"ABC",createdAt:"2023-05-26T06:30:04.445Z",updatedAt:"2023-05-26T06:30:04.445Z"},billingContact:{id:"1",name:"Company ABC",accountNumber:null,addressLine1:null,addressLine2:null,addressLine3:null,city:null,state:null,country:"SGP",postcode:null,contactNumber1:null,contactNumber2:null,contactNumber3:null,contactPerson1:null,contactPerson2:null,contactPerson3:null,contactEmail1:null,contactEmail2:null,contactEmail3:null,url1:null,url2:null,url3:null,logo:null,customFields:null,createdAt:"2023-05-26T06:30:24.570Z",updatedAt:"2023-05-26T06:30:24.570Z"},currency:{id:"1",code:"USD",symbol:"$",exchangeRate:1,effectiveStart:"2012-12-31T16:00:00.000Z",effectiveEnd:null,createdAt:"2023-05-26T06:29:49.052Z",updatedAt:"2023-05-26T06:29:49.052Z"}}}),(e,t)=>(m(),g("div",ee,[C("h2",te,[F(W(l(M))+" ",1),l(u)?T("",!0):(m(),g("i",{key:0,class:"fa-solid fa-circle-exclamation",onClick:w}))]),C("div",ae,[h(l($),{modelValue:l(f),"onUpdate:modelValue":t[0]||(t[0]=n=>Y(f)?f.value=n:null),label:"Template Name",size:"lg","error-message":y("name")},null,8,["modelValue","error-message"])]),a.value?(m(),G(X,{key:0,"template-type":l(o),"templates-url":l(Z),id:a.value.id,"content-markup":a.value.contentMarkup,"content-styles":a.value.contentStyles,data:v.value,disabled:k.disabled,"enable-generate":!1,"error-messages":l(D),onContentMarkupChange:E,onContentStylesChange:I,onDataChange:B},null,8,["template-type","templates-url","id","content-markup","content-styles","data","disabled","error-messages"])):T("",!0),l(u)?T("",!0):(m(),g("div",ne,[h(l(z),{value:"Create Template",icon:"fa-solid fa-check",onClick:U})])),h(l(H),{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=n=>i.value=n),title:"Reminder",content:"You have not saved your template. Make sure to click on Create Template to submit the changes.",width:600,height:250},null,8,["modelValue"])]))}},ie=q(le,[["__scopeId","data-v-35940c4f"]]);export{ie as default};
